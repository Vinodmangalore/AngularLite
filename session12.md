### *Session 12*

# Tour of Heroes app and tutorial

This *Tour of Heroes* tutorial shows you how to set up your local development environment and develop an application using the `Angular CLI tool`, and provides an introduction to the fundamentals of Angular.

The *Tour of Heroes* application that you build helps a staffing agency manage its stable of heroes. The application has many of the features you'd expect to find in any data-driven application. The finished application acquires and displays a list of heroes, edits a selected hero's detail, and navigates among different views of heroic data.

You will find references to and expansions of this application domain in many of the examples used throughout the Angular documentation, but you don't necessarily need to work through this tutorial to understand those examples.

By the end of this tutorial you will be able to do the following:

* Use built-in Angular directives to show and hide elements and display lists of hero data.
*  Create Angular components to display hero details and show an array of heroes.
*  Use one-way data binding for read-only data.
* Add editable fields to update a model with two-way data binding.
* Bind component methods to user events, like keystrokes and clicks.
* Enable users to select a hero from a master list and edit that hero in the details view.
* Format data with pipes.
* Create a shared service to assemble the heroes.
* Use routing to navigate among different views and their components.

# Create a new project
You begin by creating an initial application using the Angular CLI. Throughout this tutorial, you’ll modify and extend that starter application to create the Tour of Heroes application.

In this part of the tutorial, you'll do the following:

1. Set up your environment.
2. Create a new workspace and initial application project.
3. Serve the application.
4. Make changes to the application.

## Set up your environment
To set up your development environment, follow the instructions in Local Environment Setup.

## Create a new workspace and an initial application

You develop applications in the context of an Angular workspace. A workspace contains the files for one or more projects. A project is the set of files that comprise an application or a library. For this tutorial, you will create a new workspace.

To create a new workspace and an initial application project:

1. Ensure that you are not already in an Angular workspace folder. For example, if you have previously created the Getting Started workspace, change to the parent of that folder.

2. Run the CLI command `ng new` and provide the name `angular-tour-of-heroes`, as shown here:

```
ng new angular-tour-of-heroes
```
3. The ng new command prompts you for information about features to include in the initial application project. Accept the defaults by pressing the Enter or Return key.

The Angular CLI installs the necessary Angular npm packages and other dependencies. This can take a few minutes.

It also creates the following workspace and starter project files:
* A new workspace, with a root folder named angular-tour-of-heroes.
* An initial skeleton app project in the src/app subfolder.
* Related configuration files.

The initial app project contains a simple Welcome application, ready to run.

## Serve the application

Go to the workspace directory and launch the application.

```
cd angular-tour-of-heroes
ng serve --open
```
>The `ng serve` command builds the app, starts the development server, watches the source files, and rebuilds the application as you make changes to those files.<br> 
The `--open` flag opens a browser to `http://localhost:4200/`.

You should see the application running in your browser.

## Angular components

The page you see is the application shell. The shell is controlled by an Angular **component** named `AppComponent`.

*Components* are the fundamental building blocks of Angular applications. They display data on the screen, listen for user input, and take action based on that input.

## Make changes to the application
Open the project in your favorite editor or IDE and navigate to the `src/app` folder to make some changes to the starter application.

You'll find the implementation of the shell `AppComponent` distributed over three files:

1. `app.component.ts`— the component class code, written in TypeScript.
2. `app.component.html`— the component template, written in HTML.
3. `app.component.css`— the component's private CSS styles.

### Change the application title

Open the component class file (`app.component.ts`) and change the value of the `title` property to 'Tour of Heroes'.

`app.component.ts (class title property)`
```typescript
title = 'Tour of Heroes';
```
Open the component template file (`app.component.html`) and delete the default template generated by the Angular CLI. Replace it with the following line of HTML.

`app.component.html (template)`
```html
<h1>{{title}}</h1>
```
The double curly braces are Angular's *interpolation* binding syntax. This interpolation binding presents the component's `title` property value inside the HTML header tag.

The browser refreshes and displays the new application title.

### Add application styles
Most apps strive for a consistent look across the application. The CLI generated an empty `styles.css` for this purpose. Put your application-wide styles there.

Open `src/styles.css` and add the code below to the file.

`src/styles.css (excerpt)`
``` css
/* Application-wide Styles */
h1 {
  color: #369;
  font-family: Arial, Helvetica, sans-serif;
  font-size: 250%;
}
h2, h3 {
  color: #444;
  font-family: Arial, Helvetica, sans-serif;
  font-weight: lighter;
}
body {
  margin: 2em;
}
body, input[type="text"], button {
  color: #333;
  font-family: Cambria, Georgia, serif;
}
/* everywhere else */
* {
  font-family: Arial, Helvetica, sans-serif;
}
```


# Summary
* You created the initial application structure using the Angular CLI.
* You learned that Angular components display data.
* You used the double curly braces of interpolation to display the application title.

# The hero editor
The application now has a basic title. Next you will create a new component to display hero information and place that component in the application shell.

## Create the heroes component
Using the Angular CLI, generate a new component named `heroes`.

```
ng generate component heroes
```

The CLI creates a new folder, `src/app/heroes/`, and generates the three files of the `HeroesComponent` along with a test file.

The `HeroesComponent` class file is as follows:

`app/heroes/heroes.component.ts (initial version)`

```typescript
import { Component, OnInit } from '@angular/core';

@Component({
  selector: 'app-heroes',
  templateUrl: './heroes.component.html',
  styleUrls: ['./heroes.component.css']
})
export class HeroesComponent implements OnInit {

  constructor() { }

  ngOnInit(): void {
  }

}   
```

You always import the `Component` symbol from the Angular core library and annotate the component class with `@Component`.

`@Component` is a decorator function that specifies the Angular metadata for the component.

The CLI generated three metadata properties:

1. `selector`— the component's CSS element selector
2. `templateUrl`— the location of the component's template file.
3. `styleUrls`— the location of the component's private CSS styles.

The CSS element selector, `'app-heroes'`, matches the name of the HTML element that identifies this component within a parent component's template.

The `ngOnInit()` is a lifecycle hook. Angular calls `ngOnInit()` shortly after creating a component. It's a good place to put initialization logic.

Always `export` the component class so you can `import` it elsewhere ... like in the `AppModule`.

## Add a hero property
Add a hero property to the HeroesComponent for a hero named "Windstorm."

`heroes.component.ts (hero property)`
```typescript
hero = 'Windstorm';
```

## Show the hero
Open the `heroes.component.html` template file. Delete the default text generated by the Angular CLI and replace it with a data binding to the new `hero` property.

`heroes.component.html`
```html
<h2>{{hero}}</h2>
```

## Show the HeroesComponent view
To display the `HeroesComponent`, you must add it to the template of the shell `AppComponent`.

Remember that `app-heroes` is the element selector for the `HeroesComponent`. So add an `<app-heroes>` element to the `AppComponent` template file, just below the title.

`src/app/app.component.html`
```html
<h1>{{title}}</h1>
<app-heroes></app-heroes>
```
Assuming that the CLI `ng serve` command is still running, the browser should refresh and display both the application title and the hero name.

## Create a Hero interface
A real hero is more than a name.

Create a `Hero` interface in its own file in the `src/app` folder. Give it `id` and `name` properties.

`src/app/hero.ts`
```typescript
content_copy
export interface Hero {
  id: number;
  name: string;
}
```

Return to the `HeroesComponent` class and import the `Hero` interface.

Refactor the component's `hero` property to be of type `Hero`. Initialize it with an `id` of `1` and the name `Windstorm`.

The revised `HeroesComponent` class file should look like this:
`src/app/heroes/heroes.component.ts`
```html
import { Component, OnInit } from '@angular/core';
import { Hero } from '../hero';

@Component({
  selector: 'app-heroes',
  templateUrl: './heroes.component.html',
  styleUrls: ['./heroes.component.css']
})
export class HeroesComponent implements OnInit {
  hero: Hero = {
    id: 1,
    name: 'Windstorm'
  };

  constructor() { }

  ngOnInit(): void {
  }

}
```
The page no longer displays properly because you changed the hero from a string to an object.

## Show the hero object
Update the binding in the template to announce the hero's name and show both `id` and `name` in a details layout like this:

`heroes.component.html (HeroesComponent's template)`

```html
<h2>{{hero.name}} Details</h2>
<div><span>id: </span>{{hero.id}}</div>
<div><span>name: </span>{{hero.name}}</div>
```
The browser refreshes and displays the hero's information.

## Format with the _UppercasePipe_

Modify the `hero.name` binding like this.

`src/app/heroes/heroes.component.html`
``` html
<h2>{{hero.name | uppercase}} Details</h2>
```

The browser refreshes and now the hero's name is displayed in capital letters.

The word `uppercase` in the interpolation binding, right after the pipe operator ( | ), activates the built-in `UppercasePipe`.

Pipes are a good way to format strings, currency amounts, dates and other display data. Angular ships with several built-in pipes and you can create your own.

## Edit the hero
Users should be able to edit the hero name in an `<input>` textbox.

The textbox should both _display_ the hero's name property and _update_ that property as the user types. That means data flows from the component class _out to the screen_ and from the screen _back to the class_.

To automate that data flow, setup a two-way data binding between the `<input>` form element and the `hero.name` property.

## Two-way binding

Refactor the details area in the `HeroesComponent` template so it looks like this:

`src/app/heroes/heroes.component.html (HeroesComponent's template)`
```html
<div>
  <label for="name">Hero name: </label>
  <input id="name" [(ngModel)]="hero.name" placeholder="name">
</div>
```

[(ngModel)] is Angular's two-way data binding syntax.

Here it binds the `hero.name` property to the HTML textbox so that data can flow in both directions: from the `hero.name` property to the textbox, and from the textbox back to the `hero.name`.

## The missing _FormsModule_
Notice that the application stopped working when you added `[(ngModel)]`.

To see the error, open the browser development tools and look in the console for a message like

```
Template parse errors:
Can't bind to 'ngModel' since it isn't a known property of 'input'.
```

Although `ngModel` is a valid Angular directive, it isn't available by default.

It belongs to the optional `FormsModule` and you must _opt-in_ to using it.

## _AppModule_
Angular needs to know how the pieces of your application fit together and what other files and libraries the application requires. This information is called _metadata_.

Some of the metadata is in the `@Component` decorators that you added to your component classes. Other critical metadata is in `@NgModul`e decorators.

The most important `@NgModule` decorator annotates the top-level __AppModule__ class.

The Angular CLI generated an `AppModule` class in `src/app/app.module.ts` when it created the project. This is where you opt-in to the `FormsModule`.

## Import _FormsModule_
Open `AppModule` (`app.module.ts`) and import the `FormsModule` symbol from the `@angular/forms` library.

`app.module.ts (FormsModule symbol import)`
```typescript
import { FormsModule } from '@angular/forms'; // <-- NgModel lives here
```

Then add `FormsModule` to the `@NgModule` metadata's `imports` array, which contains a list of external modules that the application needs.
`app.module.ts (@NgModule imports)`
```typescript
imports: [
  BrowserModule,
  FormsModule
],
```

When the browser refreshes, the application should work again. You can edit the hero's name and see the changes reflected immediately in the `<h2>` above the textbox.

## Declare HeroesComponent
Every component must be declared in _exactly one_ NgModule.

_You_ didn't declare the `HeroesComponent`. So why did the application work?

It worked because the Angular CLI declared `HeroesComponent` in the `AppModule` when it generated that component.

Open `src/app/app.module.ts` and find `HeroesComponent` imported near the top.

`src/app/app.module.ts`
```typescript
import { HeroesComponent } from './heroes/heroes.component';
```
The `HeroesComponent` is declared in the `@NgModule.declarations` array.

`src/app/app.module.ts`
```typescript
declarations: [
  AppComponent,
  HeroesComponent
],
```
Note that `AppModule` declares both application components, `AppComponent` and `HeroesComponent`.

## Summary
* You used the CLI to create a second HeroesComponent.
* You displayed the HeroesComponent by adding it to the AppComponent shell.
* You applied the UppercasePipe to format the name.
* You used two-way data binding with the ngModel directive.
* You learned about the AppModule.
* You imported the FormsModule in the AppModule so that Angular would recognize and apply the ngModel directive.
* You learned the importance of declaring components in the AppModule and appreciated that the CLI declared it for you.

### *End of session 12*